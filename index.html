<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Investment Education Tool</title>
    <!-- Required CDN links -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --md-sys-color-primary: #006A6A;
            --md-sys-color-on-primary: #FFFFFF;
            --md-sys-color-primary-container: #6FF7F7;
            --md-sys-color-on-primary-container: #002020;
            --md-sys-color-secondary: #4A6363;
            --md-sys-color-on-secondary: #FFFFFF;
            --md-sys-color-secondary-container: #CCE8E7;
            --md-sys-color-on-secondary-container: #051F1F;
            --md-sys-color-tertiary: #4B607C;
            --md-sys-color-error: #BA1A1A;
            --md-sys-color-background: #FAFDFC;
            --md-sys-color-on-background: #191C1C;
            --md-sys-color-surface: #FAFDFC;
            --md-sys-color-on-surface: #191C1C;
            --md-sys-color-surface-variant: #DAE5E4;
            --md-sys-color-outline: #6F7978;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Roboto', sans-serif;
            line-height: 1.5;
            color: var(--md-sys-color-on-surface);
            background-color: var(--md-sys-color-background);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 24px;
        }

        .header {
            background-color: var(--md-sys-color-surface);
            padding: 16px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .module {
            display: none;
            animation: fadeIn 0.3s ease-out;
        }

        .module.active {
            display: block;
        }

        .card {
            background: var(--md-sys-color-surface);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 16px;
        }

        .nav-buttons button {
            flex: 1;
            min-width: 200px;
        }

        .calculator {
            margin: 20px 0;
            padding: 20px;
            background: var(--md-sys-color-surface-variant);
            border-radius: 8px;
        }

        .input-group {
            margin-bottom: 16px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--md-sys-color-on-surface);
        }

        input, select {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--md-sys-color-outline);
            border-radius: 4px;
            font-size: 16px;
        }

        button {
            background: var(--md-sys-color-primary);
            color: var(--md-sys-color-on-primary);
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        button:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }

        .chart-container {
            margin: 20px 0;
            height: 400px;
            position: relative;
            background: white;
            padding: 20px;
            border-radius: 8px;
        }

        .quiz-container {
            margin: 20px 0;
        }

        .quiz-question {
            margin-bottom: 20px;
            padding: 20px;
            background: var(--md-sys-color-surface-variant);
            border-radius: 8px;
        }

        .quiz-options {
            display: grid;
            gap: 10px;
        }

        .quiz-option {
            padding: 15px;
            border: 1px solid var(--md-sys-color-outline);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .quiz-option:hover {
            background: var(--md-sys-color-surface-variant);
        }

        .quiz-option.correct {
            background: #4CAF50;
            color: white;
        }

        .quiz-option.incorrect {
            background: #f44336;
            color: white;
        }

        .explanation {
            background: var(--md-sys-color-secondary-container);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--md-sys-color-outline);
        }

        th {
            background-color: var(--md-sys-color-surface-variant);
        }

        .result-highlight {
            font-weight: bold;
            color: var(--md-sys-color-primary);
            font-size: 1.2em;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 16px;
            }

            .card {
                padding: 16px;
            }

            .nav-buttons button {
                min-width: 100%;
            }

            .chart-container {
                height: 300px;
            }
        }

        /* Tooltip styles */
        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: var(--md-sys-color-surface);
            color: var(--md-sys-color-on-surface);
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            font-size: 14px;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="container">
            <h1>Investment Education Tool</h1>
        </div>
    </header>

    <div class="container">
        <!-- Navigation -->
        <div class="card">
            <h2>Investment Learning Modules</h2>
            <div class="nav-buttons">
                <button onclick="showModule('module1')">
                    <span class="material-symbols-rounded">trending_up</span>
                    Power of Compounding
                </button>
                <button onclick="showModule('module2')">
                    <span class="material-symbols-rounded">analytics</span>
                    Mutual Fund Evaluation
                </button>
                <button onclick="showModule('module3')">
                    <span class="material-symbols-rounded">compare</span>
                    Index Comparison
                </button>
                <button onclick="showModule('module4')">
                    <span class="material-symbols-rounded">warning</span>
                    Investment Mistakes
                </button>
                <button onclick="showModule('module5')">
                    <span class="material-symbols-rounded">school</span>
                    Investment Practice
                </button>
            </div>
        </div>

        <!-- Module 1: Power of Compounding -->
        <div id="module1" class="module">
            <div class="card">
                <h2>The Power of Compounding</h2>
                <div class="explanation">
                    <p>"Compound interest is the eighth wonder of the world. He who understands it, earns it; he who doesn't, pays it." - Albert Einstein</p>
                    <h3>Rule of 72</h3>
                    <p>The Rule of 72 is a simple way to determine how long an investment will take to double given a fixed annual rate of return. Just divide 72 by the annual rate of return.</p>
                    <p>For example: At 7% annual returns, money doubles in approximately 72 รท 7 = 10.3 years.</p>
                </div>
                
                <div class="calculator">
                    <h3>Compound Interest Calculator</h3>
                    <div class="input-group">
                        <label for="principal">Initial Investment ($)</label>
                        <input type="number" id="principal" value="10000">
                    </div>
                    <div class="input-group">
                        <label for="monthlyContribution">Monthly Contribution ($)</label>
                        <input type="number" id="monthlyContribution" value="500">
                    </div>
                    <div class="input-group">
                        <label for="rate">Annual Return (%)</label>
                        <input type="number" id="rate" value="7">
                    </div>
                    <div class="input-group">
                        <label for="years">Time Period (Years)</label>
                        <input type="number" id="years" value="30">
                    </div>
                    <button onclick="calculateCompound()">Calculate Growth</button>
                </div>
                
                <div id="compoundingChart" class="chart-container">
                    <canvas id="compoundingCanvas"></canvas>
                </div>
            </div>
        </div>

        <!-- Module 2: Mutual Fund Evaluation -->
        <div id="module2" class="module">
            <div class="card">
                <h2>Mutual Fund Evaluation</h2>
                <div class="explanation">
                    <h3>Key Evaluation Criteria</h3>
                    <ul>
                        <li>Expense Ratio: Typically, lower is better. Index funds often have ratios below 0.2%</li>
                        <li>Performance: Compare against appropriate benchmarks</li>
                        <li>Risk Measures: Consider Sharpe ratio and standard deviation</li>
                        <li>Morningstar Rating: Independent analysis on a 1-5 star scale</li>
                    </ul>
                </div>

                <div class="calculator">
                    <h3>Fund Cost Comparison Calculator</h3>
                    <div class="input-group">
                        <label for="investment">Initial Investment ($)</label>
                        <input type="number" id="investment" value="100000">
                    </div>
                    <div class="input-group">
                        <label for="fund1Expense">Fund 1 Expense Ratio (%)</label>
                        <input type="number" id="fund1Expense" step="0.01" value="0.04">
                    </div>
                    <div class="input-group">
                        <label for="fund2Expense">Fund 2 Expense Ratio (%)</label>
                        <input type="number" id="fund2Expense" step="0.01" value="0.75">
                    </div>
                    <button onclick="compareFunds()">Compare Costs Over Time</button>
                </div>

                <div id="fundComparisonChart" class="chart-container">
                    <canvas id="fundCanvas"></canvas>
                </div>
            </div>
        </div>

        <!-- Module 3: Index Comparison -->
        <div id="module3" class="module">
            <div class="card">
                <h2>S&P 500 vs Small Cap Value Comparison</h2>
                <div class="explanation">
                    <h3>Historical Performance (1926-2023)</h3>
                    <p>Based on Fama-French research, small cap value stocks have historically outperformed the broader market due to size and value risk premiums.</p>
                </div>

                <div id="indexComparisonChart" class="chart-container">
                    <canvas id="indexCanvas"></canvas>
                </div>

                <button onclick="showIndexComparison()">Show Historical Comparison</button>
            </div>
        </div>

        <!-- Module 4: Investment Mistakes -->
        <div id="module4" class="module">
            <div class="card">
                <h2>Common Investment Mistakes</h2>
                <div class="explanation">
                    <h3>Top 3 Mistakes to Avoid</h3>
                    <ol>
                        <li>Timing the Market</li>
                        <li>Ignoring Fees</li>
                        <li>Lack of Diversification</li>
                    </ol>
                </div>

                <div class="calculator">
                    <h3>Cost of Market Timing Calculator</h3>
                    <div class="input-group">
                        <label for="investmentAmount">Investment Amount ($)</label>
                        <input type="number" id="investmentAmount" value="10000">
                    </div>
                    <div class="input-group">
                        <label for="missedDays">Number of Best Days Missed</label>
                        <input type="number" id="missedDays" value="10">
                    </div>
                    <button onclick="calculateTimingImpact()">Calculate Impact</button>
                </div>

                <div id="timingImpactChart" class="chart-container">
                    <canvas id="timingCanvas"></canvas>
                </div>
            </div>
        </div>

        <!-- Module 5: Investment Practice -->
        <div id="module5" class="module">
            <div class="card">
                <h2>Investment Practice</h2>
                <div class="explanation">
                    <h3>Portfolio Rebalancing Exercise</h3>
                    <p>Practice maintaining your target asset allocation through market changes.</p>
                </div>

                <div class="calculator">
                    <h3>Portfolio Rebalancing Simulator</h3>
                    <div class="input-group">
                        <label for="stockAllocation">Target Stock Allocation (%)</label>
                        <input type="number" id="stockAllocation" value="70">
                    </div>
                    <div class="input-group">
                        <label for="bondAllocation">Target Bond Allocation (%)</label>
                        <input type="number" id="bondAllocation" value="30">
                    </div>
                    <div class="input-group">
                        <label for="portfolioValue">Current Portfolio Value ($)</label>
                        <input type="number" id="portfolioValue" value="100000">
                    </div>
                    <button onclick="simulateRebalancing()">Simulate Market Changes</button>
                </div>

                <div id="rebalancingChart" class="chart-container">
                    <canvas id="rebalancingCanvas"></canvas>
                </div>

                <div class="quiz-container">
                    <h3>Knowledge Check</h3>
                    <div id="quizContent"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global chart instances
        let compoundingChart = null;
        let fundComparisonChart = null;
        let indexComparisonChart = null;
        let timingImpactChart = null;
        let rebalancingChart = null;

        // Quiz questions database
        const quizQuestions = [
            {
                question: "Using the Rule of 72, approximately how long will it take to double your money at 6% annual returns?",
                options: ["8 years", "12 years", "15 years", "10 years"],
                correct: 1,
                explanation: "72 รท 6 = 12 years"
            },
            {
                question: "What is typically considered a high expense ratio for an index fund?",
                options: ["0.1%", "0.3%", "0.5%", "Above 0.75%"],
                correct: 3,
                explanation: "Index funds should typically have expense ratios below 0.2%"
            },
            {
                question: "According to Fama-French research, what has historically led to small cap value outperformance?",
                options: ["Pure luck", "Size and value risk premiums", "Marketing", "Lower costs"],
                correct: 1,
                explanation: "The size and value risk premiums have historically provided higher returns"
            }
        ];

        // Navigation function
        function showModule(moduleId) {
            document.querySelectorAll('.module').forEach(module => {
                module.classList.remove('active');
            });
            document.getElementById(moduleId).classList.add('active');

            // Initialize specific module content
            if (moduleId === 'module5') {
                initializeQuiz();
            }
        }

        // Compound interest calculator
        function calculateCompound() {
            const principal = parseFloat(document.getElementById('principal').value);
            const monthlyContribution = parseFloat(document.getElementById('monthlyContribution').value);
            const rate = parseFloat(document.getElementById('rate').value) / 100;
            const years = parseInt(document.getElementById('years').value);
            
            let data = {
                labels: [],
                principalData: [],
                totalData: []
            };
            
            let balance = principal;
            let totalContributions = principal;
            
            for (let year = 0; year <= years; year++) {
                data.labels.push(`Year ${year}`);
                data.principalData.push(totalContributions);
                data.totalData.push(balance);
                
                balance = balance * (1 + rate) + (monthlyContribution * 12);
                totalContributions += monthlyContribution * 12;
            }

            displayCompoundingChart(data);
        }

        // Display compounding chart
        function displayCompoundingChart(data) {
            const ctx = document.getElementById('compoundingCanvas').getContext('2d');
            
            if (compoundingChart) {
                compoundingChart.destroy();
            }

            compoundingChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.labels,
                    datasets: [{
                        label: 'Total Value',
                        data: data.totalData,
                        borderColor: 'rgb(0, 106, 106)',
                        backgroundColor: 'rgba(0, 106, 106, 0.1)',
                        fill: true
                    }, {
                        label: 'Total Contributions',
                        data: data.principalData,
                        borderColor: 'rgb(74, 99, 99)',
                        backgroundColor: 'rgba(74, 99, 99, 0.1)',
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': $' + context.raw.toLocaleString();
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            ticks: {
                                callback: function(value) {
                                    return '$' + value.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });
        }

        // Fund comparison calculator
        function compareFunds() {
            const investment = parseFloat(document.getElementById('investment').value);
            const fund1Expense = parseFloat(document.getElementById('fund1Expense').value) / 100;
            const fund2Expense = parseFloat(document.getElementById('fund2Expense').value) / 100;
            const years = 30;
            const marketReturn = 0.07;

            let data = {
                labels: [],
                fund1Data: [],
                fund2Data: []
            };

            let balance1 = investment;
            let balance2 = investment;

            for (let year = 0; year <= years; year++) {
                data.labels.push(`Year ${year}`);
                data.fund1Data.push(balance1);
                data.fund2Data.push(balance2);

                balance1 *= (1 + marketReturn - fund1Expense);
                balance2 *= (1 + marketReturn - fund2Expense);
            }

            displayFundComparison(data);
        }

        // Display fund comparison chart
        function displayFundComparison(data) {
            const ctx = document.getElementById('fundCanvas').getContext('2d');
            
            if (fundComparisonChart) {
                fundComparisonChart.destroy();
            }

            fundComparisonChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.labels,
                    datasets: [{
                        label: 'Low-Cost Fund',
                        data: data.fund1Data,
                        borderColor: 'rgb(0, 106, 106)',
                        backgroundColor: 'rgba(0, 106, 106, 0.1)',
                        fill: true
                    }, {
                        label: 'High-Cost Fund',
                        data: data.fund2Data,
                        borderColor: 'rgb(186, 26, 26)',
                        backgroundColor: 'rgba(186, 26, 26, 0.1)',
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': $' + context.raw.toLocaleString();
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            ticks: {
                                callback: function(value) {
                                    return '$' + value.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });
        }

        // Show index comparison
        function showIndexComparison() {
            const ctx = document.getElementById('indexCanvas').getContext('2d');
            
            if (indexComparisonChart) {
                indexComparisonChart.destroy();
            }

            // Historical data (simplified for demonstration)
            const data = {
                labels: ['1926', '1936', '1946', '1956', '1966', '1976', '1986', '1996', '2006', '2016', '2023'],
                sp500: [1, 1.5, 2.8, 5.2, 8.1, 12.4, 25.6, 85.3, 156.2, 245.8, 380.5],
                smallCapValue: [1, 1.8, 3.5, 7.1, 11.2, 18.6, 42.3, 145.6, 284.5, 456.2, 680.2]
            };

            indexComparisonChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.labels,
                    datasets: [{
                        label: 'S&P 500',
                        data: data.sp500,
                        borderColor: 'rgb(0, 106, 106)',
                        backgroundColor: 'rgba(0, 106, 106, 0.1)',
                        fill: true
                    }, {
                        label: 'Small Cap Value',
                        data: data.smallCapValue,
                        borderColor: 'rgb(75, 96, 124)',
                        backgroundColor: 'rgba(75, 96, 124, 0.1)',
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            type: 'logarithmic',
                            ticks: {
                                callback: function(value) {
                                    return `${value}x`;
                                }
                            }
                        }
                    }
                }
            });
        }

        // Calculate timing impact
        function calculateTimingImpact() {
            const investment = parseFloat(document.getElementById('investmentAmount').value);
            const missedDays = parseInt(document.getElementById('missedDays').value);
            
            // Historical data shows missing the 10 best days can reduce returns by roughly half
            const fullReturn = investment * 2.5;
            const missedReturn = investment * (1 + (1.5 * (10 - missedDays) / 10));
            
            const ctx = document.getElementById('timingCanvas').getContext('2d');
            
            if (timingImpactChart) {
                timingImpactChart.destroy();
            }

            timingImpactChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Stayed Invested', 'Missed Best Days'],
                    datasets: [{
                        label: 'Portfolio Value',
                        data: [fullReturn, missedReturn],
                        backgroundColor: [
                            'rgba(0, 106, 106, 0.6)',
                            'rgba(186, 26, 26, 0.6)'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return '$' + context.raw.toLocaleString();
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            ticks: {
                                callback: function(value) {
                                    return '$' + value.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });
        }

        // Simulate portfolio rebalancing
        function simulateRebalancing() {
            const stockTarget = parseFloat(document.getElementById('stockAllocation').value) / 100;
            const bondTarget = parseFloat(document.getElementById('bondAllocation').value) / 100;
            const portfolioValue = parseFloat(document.getElementById('portfolioValue').value);
            
            // Simulate market changes
            const marketChanges = [
                { stocks: 0.15, bonds: 0.02 },
                { stocks: -0.10, bonds: 0.05 },
                { stocks: 0.20, bonds: -0.01 },
                { stocks: -0.05, bonds: 0.08 }
            ];

            let data = {
                labels: ['Initial', 'Q1', 'Q2', 'Q3', 'Q4'],
                stocksActual: [stockTarget],
                bondsActual: [bondTarget],
                stocksTarget: [stockTarget],
                bondsTarget: [bondTarget]
            };

            let currentStocks = portfolioValue * stockTarget;
            let currentBonds = portfolioValue * bondTarget;

            marketChanges.forEach(change => {
                currentStocks *= (1 + change.stocks);
                currentBonds *= (1 + change.bonds);
                const total = currentStocks + currentBonds;
                
                data.stocksActual.push(currentStocks / total);
                data.bondsActual.push(currentBonds / total);
                data.stocksTarget.push(stockTarget);
                data.bondsTarget.push(bondTarget);
            });

            displayRebalancing(data);
        }

        // Display rebalancing chart
        function displayRebalancing(data) {
            const ctx = document.getElementById('rebalancingCanvas').getContext('2d');
            
            if (rebalancingChart) {
                rebalancingChart.destroy();
            }

            rebalancingChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.labels,
                    datasets: [{
                        label: 'Actual Stock Allocation',
                        data: data.stocksActual.map(v => v * 100),
                        borderColor: 'rgb(0, 106, 106)',
                        borderDash: []
                    }, {
                        label: 'Target Stock Allocation',
                        data: data.stocksTarget.map(v => v * 100),
                        borderColor: 'rgb(0, 106, 106)',
                        borderDash: [5, 5]
                    }, {
                        label: 'Actual Bond Allocation',
                        data: data.bondsActual.map(v => v * 100),
                        borderColor: 'rgb(75, 96, 124)',
                        borderDash: []
                    }, {
                        label: 'Target Bond Allocation',
                        data: data.bondsTarget.map(v => v * 100),
                        borderColor: 'rgb(75, 96, 124)',
                        borderDash: [5, 5]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    }
                }
options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                ticks: {
                                    callback: function(value) {
                                        return value + '%';
                                    }
                                }
                            }
                        },
                        plugins: {
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return context.dataset.label + ': ' + context.raw.toFixed(1) + '%';
                                    }
                                }
                            }
                        }
                    }
                }
            });
        }

        // Quiz functionality
        function initializeQuiz() {
            const quizContainer = document.getElementById('quizContent');
            quizContainer.innerHTML = '';

            quizQuestions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'quiz-question';
                
                questionDiv.innerHTML = `
                    <h4>Question ${index + 1}: ${q.question}</h4>
                    <div class="quiz-options">
                        ${q.options.map((option, i) => `
                            <div class="quiz-option" onclick="checkAnswer(${index}, ${i})">
                                ${option}
                            </div>
                        `).join('')}
                    </div>
                    <div id="explanation-${index}" class="explanation" style="display: none;"></div>
                `;
                
                quizContainer.appendChild(questionDiv);
            });
        }

        function checkAnswer(questionIndex, selectedIndex) {
            const question = quizQuestions[questionIndex];
            const options = document.querySelectorAll(`.quiz-question:nth-child(${questionIndex + 1}) .quiz-option`);
            const explanationDiv = document.getElementById(`explanation-${questionIndex}`);
            
            options.forEach((option, index) => {
                if (index === question.correct) {
                    option.classList.add('correct');
                } else if (index === selectedIndex) {
                    option.classList.add('incorrect');
                }
                option.onclick = null; // Prevent further clicks
            });

            explanationDiv.style.display = 'block';
            explanationDiv.innerHTML = `
                <p><strong>${selectedIndex === question.correct ? 'Correct!' : 'Incorrect.'}</strong></p>
                <p>${question.explanation}</p>
            `;
        }

        // Helper functions
        function formatMoney(amount) {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(amount);
        }

        function formatPercent(value) {
            return new Intl.NumberFormat('en-US', {
                style: 'percent',
                minimumFractionDigits: 1,
                maximumFractionDigits: 1
            }).format(value);
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Show first module by default
            showModule('module1');
            
            // Calculate initial compound interest example
            calculateCompound();
            
            // Add input validation
            document.querySelectorAll('input[type="number"]').forEach(input => {
                input.addEventListener('input', function() {
                    let value = this.value.replace(/[^\d.-]/g, '');
                    if (this.id.includes('Allocation')) {
                        value = Math.min(100, Math.max(0, value));
                    }
                    this.value = value;
                });
            });
        });
    </script>
</body>
</html>
